#!/bin/bash
# Application Package Manager Wrapper
# Checks which package manager is in use on this system, and runs the the corresponding helper script.
# Currently only checks for apt and apk, but will be extended to cover other package managers.
# See end of this script for list of package managers to be added.

# Define colors
RED='\e[31m'
NC='\e[0m' # No Color

# Get the directory of the current script
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" &> /dev/null && pwd)"

# Function to check if a command exists
command_exists() {
    command -v "$1" &> /dev/null
}

# Check if apt is available
if command_exists apt; then
    APTX_SCRIPT="${SCRIPT_DIR}/aptx"
    # Check if aptx script exists and is executable
    if [ -x "$APTX_SCRIPT" ]; then
        # Execute aptx script with all arguments
        exec "$APTX_SCRIPT" "$@"
    else
        echo -e "${RED}Error: 'apt' command found, but 'aptx' script not found or not executable at '$APTX_SCRIPT'.${NC}"
        exit 1
    fi
# Check if apk is available
elif command_exists apk; then
    APKX_SCRIPT="${SCRIPT_DIR}/apkx"
     # Check if apkx script exists and is executable
    if [ -x "$APKX_SCRIPT" ]; then
        # Execute apkx script with all arguments
        exec "$APKX_SCRIPT" "$@"
    else
        echo -e "${RED}Error: 'apk' command found, but 'apkx' script not found or not executable at '$APKX_SCRIPT'.${NC}"
        exit 1
    fi
else
    # Neither apt nor apk found
    echo -e "${RED}Error: Neither 'apt' nor 'apk' package manager found on this system.${NC}"
    exit 1
fi

# The script should not reach here due to 'exec'
exit 0

####################

# - APT (Advanced Package Tool): This is one of the most widely used package management systems. It's known for its robust dependency resolution and ease of use.
# Associated Distributions: Debian, Ubuntu, Linux Mint, Kali Linux, and many other Debian-based distributions.   
# Package Format: .deb

# apk (Alpine Package Keeper): A simple, fast, and lightweight package manager designed for the Alpine Linux distribution, which is popular in container environments.    
# Associated Distributions: Alpine Linux.
# Package Format: .apk

# - DNF (Dandified YUM): DNF is the next-generation version of YUM (Yellowdog Updater, Modified) and is the default package manager for newer Red Hat-based distributions.
# Associated Distributions: Fedora, CentOS Stream, Rocky Linux, AlmaLinux, Red Hat Enterprise Linux (RHEL) 8 and later.   
# Package Format: .rpm

# - YUM (Yellowdog Updater, Modified): While largely replaced by DNF in newer releases, YUM is still found in older versions of Red Hat-based distributions.
# Associated Distributions: CentOS 7 and earlier, RHEL 7 and earlier, Fedora 21 and earlier, Amazon Linux (older versions).
# Package Format: .rpm

# Zypper: This is the command-line package manager for openSUSE, built on top of the ZYpp library.   
# Associated Distributions: openSUSE Leap, openSUSE Tumbleweed.
# Package Format: .rpm

# - Pacman: Known for its speed and simplicity, Pacman is the package manager for Arch Linux and its derivatives.   
# Associated Distributions: Arch Linux, Manjaro, EndeavourOS.   
# Package Format: .tar.xz (often compressed)   

# Portage: Distinct from binary package managers, Portage is a source-based package management system. It downloads the source code and compiles the software locally according to the user's specifications.
# Associated Distributions: Gentoo Linux, Funtoo Linux.   
# Package Format: Source-based (managed via ebuild scripts)

# pkgtool / installpkg / upgradepkg / removepkg: Slackware uses a collection of command-line tools for package management, operating more directly with compressed tarball packages. slackpkg is a common community-contributed tool for managing packages from repositories.
# Associated Distributions: Slackware Linux.
# Package Format: .tgz, .txz

